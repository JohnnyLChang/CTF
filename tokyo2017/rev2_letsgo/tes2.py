# coding: utf-8
from pwn import *
key = "KEY_TW:)"
flag = "TWCTF{ab"
t = 0L
for i in range(0, 8)
for i in range(0, 8):
    print key[i]
    
for i in range(0, 8):
    print ord(key[i])
    
    
for i in range(0, 8):
    print (ord(key[i])+ord(flag[i]))
    
    
    
for i in range(0, 8):
    print (ord(key[i])+ord(flag[i]))&0xff
    
    
    
    
for i in range(0, 8):
    print hex((ord(key[i])+ord(flag[i]))&0xff)
    
    
    
    
    
key2 = key
for j in range(0, 4):
    for i in range(0, 8):
        key2 = ord(key2[i])+ord(flag[i]))&0xff
        print hex(key2)

    
    
    
    
    
key2 = key
for j in range(0, 4):
    for i in range(0, 8):
        key2 = chr(ord(key2[i])+ord(flag[i]))&0xff)
        print hex(key2[i])

    
    
    
    
    
key2 = key
for j in range(0, 4):
    for i in range(0, 8):
        key2 = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(key2[i])
key2 = key
for j in range(0, 4):
    for i in range(0, 8):
        key2 = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
key2 = key
for j in range(0, 4):
    for i in range(0, 8):
        key2 = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
key2 = key
print key2
for j in range(0, 4):
    for i in range(0, 8):
        key2 = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
key = "KEY_TW:)"
key2 = key
print key2
for j in range(0, 4):
    for i in range(0, 8):
        key2 = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
key2 = key
print key2
for j in range(0, 4):
    for i in range(0, 8):
        key2 = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2 = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
flag = bytearray("TWCTF{ab")
key = bytearray("KEY_TW:)")
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = chr((ord(key2[i])+ord(flag[i]))&0xff)
        print hex(ord(key2[i]))
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = key2[i]+flag[i])&0xff
        print hex(key2[i])
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key2[i]+flag[i])&0xff
        print hex(key2[i])
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (ord(key2[i])+ord(flag[i]))&0xff
        print hex(key2[i])
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key2[i]+flag[i])&0xff
        print hex(key2[i])
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        t = (key2[i]+flag[i])&0xff
        print hex(key2[i])
flag = bytearray("TWCTF{ab")
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(key2[i])
        
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
flag = bytearray("TWCTF{ab")
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
        
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
        
flag2[:] = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
        
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
        
flag2 = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
        
flag
flag = bytearray("TWCTF{ab")
flag
flag2[:] = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
        
flag2[:] = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(123)
        
        
flag2[:] = flag
print flag2
for j in range(0, 4):
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        print hex(flag2[i])
        
        
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        str += hex(flag2[i])
        str += " "
    print str
     
        
xxd sbox
get_ipython().magic(u'cat sbox')
xxd -i sbox
hexudmp sbox
hexdump sbox
sbox = open('sbox', 'rb')
sboxb = sbox.read()
sbox.close()
len(sboxb)
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = sbox(flag2[i])
        str += hex(flag2[i])
        str += " "
    print str
    
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = sboxb(flag2[i])
        str += hex(flag2[i])
        str += " "
    print str
    
sboxb
box = bytearray(sboxb)
box
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box(flag2[i])
        str += hex(flag2[i])
        str += " "
    print str
    
    
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] += flag[i+1]
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        str += flag2[i]
        str += " "
    print str
    
    
    
    
flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i])
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 8)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 16)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2[:] = flag
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 16)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        #flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])&0xff
        #flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        #flag2[i] = rol(flag2[i], 0, 2)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = rol(flag2[i], 0, 16)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = rol(flag2[i], 0, 16)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = rol(flag2[i], 0, 16)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = rol(flag2[i], 1, 16)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = rol(flag2[i], 1, 8)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = flag2[i]&0xf0 | rol(flag2[i], 1, 8)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = rol(flag2[i], 1, 8)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
    
    
t=0x132
t&0xf0
hex(t&0xf0)
hex(t&0xff00)
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = flag2[i]&0xff00 | rol(flag2[i], 1, 8)
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        flag2[i] = (flag2[i]&0xff00 | rol(flag2[i], 1, 8))&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
    
    
    
    
    
    
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        flag2[i] = (key[i]+flag2[i])&0xff
        flag2[i] = box[flag2[i]]
        if i < 7:
            flag2[i] = (flag2[i] + flag[i+1])
        rcx = flag2[i]&0xff00 | rol(flag2[i], 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx = key[i]+flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = flag2[i]&0xff00 | rol(flag2[i], 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx = key[i]+flag2[i]
        rcx = box[rcx&0xff]
        print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = flag2[i]&0xff00 | rol(flag2[i], 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx = key[i]+flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
            print hex(rcx)
        rcx = flag2[i]&0xff00 | rol(flag2[i], 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx = key[i]+flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        if i = 1:
            print hex(rcx)
        rcx = key[i]+flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        if i == 1:
            print hex(rcx)
        rcx = key[i]+flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = 0
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += key[i]+flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = 0
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        if i == 1:
            print hex(rcx)
        rcx += key[i]+flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        if i == 1:
            print hex(rcx)
        rcx += flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        if i == 1:
            print hex(rcx)+hex(flag2[i])
        rcx += flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
flag2
flag2 = flag
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        if i == 1:
            print hex(rcx)+hex(flag2[i])
        rcx += flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str

    
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = rcx&0xff
        rcx = box[rcx]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    

    
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = rcx&0xff
        rcx = box[rcx]
        if i == 1:
            print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    

    
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = rcx&0xff
        if i == 1:
            print hex(rcx)
        rcx = box[rcx]
        if i == 1:
            print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    

    
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx]
        if i == 1:
            print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx&0xff]
        if i == 1:
            print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        if i == 1:
            print hex(rcx)
        rcx += flag2[i]
        if i == 1:
            print hex(rcx)
        rcx = box[rcx&0xff]
        if i == 1:
            print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        print hex(rcx)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        print hex(rcx)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += flag2[i]
        rcx = box[rcx&0xff]
        print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        print hex(rcx)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        print hex(rcx)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 6:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 6:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 6:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 8:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
    
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 6:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 8:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
        print hex(rcx)
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 6:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 8:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 8:
            rcx = (rcx + flag[i+1])
        if i == 6 print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 8:
            rcx = (rcx + flag[i+1])
        if i == 6: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 6:
            rcx = (rcx + flag[i+1])
        if i == 6: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 6: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        if i == 6: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 5:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        print hex(rcx)
        if i == 6: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
print flag2
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 5:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 6: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 5:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 6: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 5:
            print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 5: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i == 5: print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 5: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag = bytearray("TWCTF{11")
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i == 5: print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 5: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i == 5: print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 5: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i == 5: print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        if i == 5: print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
       
print hexdump(flag2)
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 4):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
       
print hexdump(flag2)
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = 0
for j in range(0, 4):
    str = ""
    rcx += flag[0]
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
       
print hexdump(flag2)
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = 0
for j in range(0, 4):
    str = ""
    if j == 1: print hex(rcx)
    rcx += flag[0]
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
       
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str+" "flag
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str+" "+hex(flag2[7])
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 7):
        if i == 7: print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str+" "+hex(flag2[7])
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 8):
        if i == 7: print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str+" "+hex(flag2[7])
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    for i in range(0, 8):
        if i == 7: print hex(rcx)
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str+" "
    
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 2):
    str = ""
    if j == 1: print hex(rcx)
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 2):
    str = ""
    if j == 1: print hex(rcx)
    for i in range(0, 8):
        rcx += key[i]
        if i == 7: print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    if j == 1: print hex(rcx)
    for i in range(0, 8):
        rcx += key[i]
        if i == 7: print hex(rcx)
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    if j == 1: print hex(rcx)
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i == 7: print hex(rcx)
        if i < 7:
            rcx = (rcx + flag[i+1])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    if j == 1: print hex(rcx)
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag2[i+1])
        else:
            rcx = (rcx + flag2[0])
            print hex(rcx)
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 1):
    str = ""
    if j == 1: print hex(rcx)
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag2[i+1])
        else:
            rcx = (rcx + flag2[0])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        print hex(rcx)
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 0x20):
    str = ""
    if j == 1: print hex(rcx)
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag2[i+1])
        else:
            rcx = (rcx + flag2[0])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        print hex(rcx)
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 0x20):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag2[i+1])
        else:
            rcx = (rcx + flag2[0])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        else:
            flag2[i+1] = rcx&0xff
        print hex(rcx)
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 0x20):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag2[i+1])
        else:
            rcx = (rcx + flag2[0])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        else:
            flag2[0] = rcx&0xff
        print hex(rcx)
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 0x20):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag2[i+1])
        else:
            rcx = (rcx + flag2[0])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        else:
            flag2[0] = rcx&0xff
        str += hex(flag2[i])
        str += " "
    print str+" "
flag2 = flag
# Rotate left: 0b1001 --> 0b0011
rol = lambda val, r_bits, max_bits:     (val << r_bits%max_bits) & (2**max_bits-1) |     ((val & (2**max_bits-1)) >> (max_bits-(r_bits%max_bits)))

flag2 = list(flag)
rcx = flag2[0]
for j in range(0, 0x20):
    str = ""
    for i in range(0, 8):
        rcx += key[i]
        rcx = box[rcx&0xff]
        if i < 7:
            rcx = (rcx + flag2[i+1])
        else:
            rcx = (rcx + flag2[0])
        rcx = rcx&0xff00 | rol(rcx, 1, 8)
        if i != 7:
            flag2[i+1] = rcx&0xff
        else:
            flag2[0] = rcx&0xff
print flag2
get_ipython().magic(u'save 167')
get_ipython().magic(u'save test  167')
get_ipython().magic(u'save tes2 ~0')
get_ipython().magic(u'save tes2 0')
get_ipython().magic(u'save tes2 0/')
