//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int32_t entry_point(int32_t a1, int32_t a2);
int32_t function_80483d4(void);
void function_8048400(void);
void function_80484a0(void);
int32_t function_80484e0(void);
int32_t function_80484f0(int32_t a1);
int32_t function_8048520(int32_t a1, int32_t a2);
int32_t function_80485ab(int32_t a1);
char * function_80486b9(char * str);
int32_t function_80486db(char * str);
int32_t function_8048738(char * a1);
int32_t function_80487b2(char * a1);
int32_t function_80487f0(int32_t a1, int32_t a2, int32_t a3);
int32_t function_804884d(int32_t a1);
void function_8048854(void);
int32_t unknown_8049ffc(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0; // ebp
int32_t g2 = 0; // ebx
int32_t g3 = 0; // esi
int32_t g4 = 0x65d92941; // 0x8048870
struct _IO_FILE * g6 = NULL; // 0x804a040
int32_t * g5 = &g4; // 0x804a038

// ------------------------ Functions -------------------------

// Address range: 0x80483d4 - 0x80483f6
int32_t function_80483d4(void) {
    int32_t result = *(int32_t *)(function_80484e0() + 0x1c1f); // 0x80483e3
    if (result != 0) {
        // 0x80483ed
        __gmon_start();
        // branch -> 0x80483f2
    }
    // 0x80483f2
    int32_t v1;
    g2 = v1;
    return result;
}

// Address range: 0x8048400 - 0x804849f
void function_8048400(void) {
    // 0x8048400
    return;
}

// Address range: 0x80484a0 - 0x80484a7
void function_80484a0(void) {
    // 0x80484a0
    unknown_8049ffc();
}

// Address range: 0x80484b0 - 0x80484df
int32_t entry_point(int32_t a1, int32_t a2) {
    int32_t v1;
    g3 = v1;
    int32_t result = __libc_start_main((int32_t * (*)(int32_t, char **, char **))function_80485ab, v1, (char **)&a1, (void (**)())function_80487f0, (void (**)())0x8048850, (void (**)())0); // 0x80484cc
    return result;
}

// Address range: 0x80484e0 - 0x80484ef
int32_t function_80484e0(void) {
    // 0x80484e0
    int32_t result;
    return result;
}

// Address range: 0x80484f0 - 0x804851f
int32_t function_80484f0(int32_t a1) {
    // 0x80484f0
    return 3;
}

// Address range: 0x8048520 - 0x80485aa
int32_t function_8048520(int32_t a1, int32_t a2) {
    // 0x8048520
    return 0;
}

// Address range: 0x80485ab - 0x80486b8
int32_t function_80485ab(int32_t a1) {
    puts("Rev! Rev! Rev!");
    printf("Your input: ");
    int32_t str;
    if (fgets((char *)&str, 33, g6) == NULL) {
        // 0x804860a
        puts("Input Error.");
        exit(0);
        // UNREACHABLE
    }
    // 0x8048624
    function_80486b9((char *)&str);
    function_80486db((char *)&str);
    function_8048738((char *)&str);
    function_80487b2((char *)&str);
    int32_t str2 = *(int32_t *)&g5; // 0x8048660
    if (strcmp((char *)&str, (char *)str2) == 0) {
        // 0x8048679
        puts("Correct!");
        // branch -> 0x804869b
    } else {
        // 0x804868b
        puts("Invalid!");
        // branch -> 0x804869b
    }
    // 0x804869b
    if (*(int32_t *)20 != *(int32_t *)20) {
        // 0x80486ac
        __stack_chk_fail();
        // branch -> 0x80486b1
    }
    // 0x80486b1
    return 0;
}

// Address range: 0x80486b9 - 0x80486da
char * function_80486b9(char * str) {
    char * found_char_pos = strchr(str, 10); // 0x80486c7
    *found_char_pos = 0;
    return found_char_pos;
}

// Address range: 0x80486db - 0x8048737
int32_t function_80486db(char * str) {
    int32_t result = (int32_t)str;
    int32_t v1 = strlen(str) - 1 + result; // 0x8048701
    if (result >= v1) {
        // 0x8048735
        return result;
    }
    char * v2 = (char *)v1;
    *str = *v2;
    *v2 = *str;
    int32_t result2 = result + 1; // 0x8048725
    int32_t v3 = v1 - 1; // 0x8048729
    while (result2 < v3) {
        // 0x8048708
        v1 = v3;
        str = (char *)result2;
        v2 = (char *)v1;
        *str = *v2;
        *v2 = *str;
        result2++;
        v3 = v1 - 1;
        // continue -> 0x8048708
    }
    // 0x8048735
    return result2;
}

// Address range: 0x8048738 - 0x80487b1
int32_t function_8048738(char * a1) {
    char v1 = *a1; // 0x80487a830
    if (v1 == 0) {
        // 0x80487af
        return 0;
    }
    uint32_t v2 = (int32_t)v1; // 0x804874c_0
    uint32_t v3 = 2 * v2 & 170 | v2 / 2 & 85; // 0x8048763
    uint32_t v4 = 4 * v3 & 204 | v3 / 4 & 51; // 0x804877e
    *a1 = (char)(0x1000000 * (16 * v4 | v4 / 16) / 0x1000000);
    int32_t v5 = (int32_t)a1 + 1; // 0x80487a1
    char * v6 = (char *)v5;
    char v7 = *v6; // 0x80487a8
    // branch -> 0x8048746
    while (v7 != 0) {
        // 0x8048746
        v2 = (int32_t)v7;
        v3 = 2 * v2 & 170 | v2 / 2 & 85;
        v4 = 4 * v3 & 204 | v3 / 4 & 51;
        *v6 = (char)(0x1000000 * (16 * v4 | v4 / 16) / 0x1000000);
        v5++;
        v6 = (char *)v5;
        v7 = *v6;
        // continue -> 0x8048746
    }
    // 0x80487a5
    // branch -> 0x80487af
    // 0x80487af
    return 0;
}

// Address range: 0x80487b2 - 0x80487ef
int32_t function_80487b2(char * a1) {
    char v1 = *a1; // 0x80487dc4
    if (v1 == 0) {
        // 0x80487e3
        return 0;
    }
    *a1 = -1 - v1;
    int32_t v2 = (int32_t)a1 + 1; // 0x80487d5
    char * v3 = (char *)v2;
    char v4 = *v3; // 0x80487dc
    // branch -> 0x80487c0
    while (v4 != 0) {
        // 0x80487c0
        *v3 = -1 - v4;
        v2++;
        v3 = (char *)v2;
        v4 = *v3;
        // continue -> 0x80487c0
    }
    // 0x80487d9
    // branch -> 0x80487e3
    // 0x80487e3
    return 0;
}

// Address range: 0x80487f0 - 0x804884c
int32_t function_80487f0(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1 = function_80484e0(); // 0x80487f4
    g1 = a1;
    function_80483d4();
    int32_t v2 = g2; // 0x8048811
    int32_t result = v2 - 248; // 0x8048811
    int32_t v3 = v1 + 0x1713 - result; // 0x8048817
    g3 = v3 / 4;
    if (v3 < 4) {
        // 0x8048845
        return result;
    }
    // 0x8048820
    ((int32_t (*)(int32_t, int32_t))*(int32_t *)(v2 - 248))(a2, a3);
    int32_t v4 = 1; // 0x804883b
    // branch -> 0x8048828
    while (v4 != g3) {
        // 0x8048828
        // 0x8048828
        ((int32_t (*)(int32_t, int32_t))*(int32_t *)(g2 - 248 + 4 * v4))(a2, a3);
        v4++;
        // branch -> 0x8048828
    }
    // 0x8048845
    return result;
}

// Address range: 0x804884d - 0x8048851
int32_t function_804884d(int32_t a1) {
    // 0x804884d
    return g3;
}

// Address range: 0x8048854 - 0x8048867
void function_8048854(void) {
    // 0x8048854
    function_80484e0();
}

// --------------- Dynamically Linked Functions ---------------

// void __gmon_start(void);
// int __libc_start_main(int *(main)(int, char **, char **), int argc, char ** ubp_av, void(* init)(void), void(* fini)(void), void(* rtld_fini)(void), void(* stack_end));
// void __stack_chk_fail(void);
// void exit(int status);
// char * fgets(char * restrict s, int n, FILE * restrict stream);
// int printf(const char * restrict format, ...);
// int puts(const char * s);
// char * strchr(char * s, int c);
// int strcmp(const char * s1, const char * s2);
// size_t strlen(const char * s);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (5.4.0)
// Detected functions: 15
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-09-02 03:15:30
